<div>
  <ion-item lines="none">
    <div
      style="display: flex; align-items: center; gap: 10px"
      (click)="onShowProfile()"
    >
      <app-avatar [src]="post().user.avatar.url" size="36px" />
      <div class="name-text-container">
        <h2 class="name-text">{{ post().user.full_name }}</h2>
        <p class="subtitle">
          {{ post().created_at | timeAgo }}
          <ion-icon
            name="ellipse-sharp"
            style="font-size: 0.2rem; opacity: 0.7"
          ></ion-icon>
          {{ post().city }}
        </p>
      </div>
    </div>

    <ion-label style="text-align: right">
      <svg
        (click)="onShowAction()"
        width="18"
        height="20"
        viewBox="0 0 18 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M2 12C3.10457 12 4 11.1046 4 10C4 8.89543 3.10457 8 2 8C0.895431 8 0 8.89543 0 10C0 11.1046 0.895431 12 2 12Z"
          fill="#B7BCC9"
        />
        <path
          d="M9 12C10.1046 12 11 11.1046 11 10C11 8.89543 10.1046 8 9 8C7.89543 8 7 8.89543 7 10C7 11.1046 7.89543 12 9 12Z"
          fill="#B7BCC9"
        />
        <path
          d="M16 12C17.1046 12 18 11.1046 18 10C18 8.89543 17.1046 8 16 8C14.8954 8 14 8.89543 14 10C14 11.1046 14.8954 12 16 12Z"
          fill="#B7BCC9"
        />
      </svg>

      @if(!post().is_private) {
      <p *ngIf="post().expiration_date">
        <ion-badge
          [ngClass]="isWithinTimeRange(post().expiration_date)"
          style="padding: 4px 12px"
        >
          {{ post().expiration_date }}
        </ion-badge>
      </p>
      <p *ngIf="!post().expiration_date">
        <ion-badge class="green-bg" style="padding: 4px 12px"> Open </ion-badge>
      </p>
      }
    </ion-label>
  </ion-item>
  <ion-item lines="none" style="--min-height: auto">
    <p
      class="post-text"
      [innerHTML]="processTextContent()"
      (click)="onHashtagClick($event)"
    ></p>
  </ion-item>

  <div
    style="margin-top: 16px"
    class="contents"
    [ngClass]="{
      grid: contents().length > 3,
    }"
  >
    @switch (identifyPostType(post())) { @case ('questions') { @for (content of
    (contents()); track content.id) {
    <div
      (click)="onGetPost()"
      style="background: #f1f1f1"
      class="ion-no-padding content"
      [appContrast]="content.question_color"
    >
      {{ content.question_text }}
    </div>
    } } @case('media') { @for (content of contents(); track content.id) {
    <div
      (click)="onGetPost()"
      style="background: #f1f1f1"
      class="ion-no-padding content"
    >
      <img src="{{ content.image_path.url }}" [alt]="content.file_name" />
    </div>
    } } @case ('saved') { @for (content of (contents()); track content.id) {
    <div
      (click)="onGetPost()"
      style="background: #f1f1f1"
      class="ion-no-padding content"
    >
      <img src="{{ content.image_url }}" [alt]="content.file_name" />
    </div>
    } } }
  </div>

  <footer>
    <div class="ion-padding-horizontal stats">
      <ion-label (click)="onShowViewers()">
        {{ post().picks_count ? post().picks_count + " Picks" : "" }}
      </ion-label>
      <div style="display: flex; margin-left: auto">
        <ion-label>{{ post().suggestions_count }} Suggestions . </ion-label>
        <ion-label (click)="onListViewers(post().id)" style="margin-left: 10px"
          >{{ post().views_count }} Views
        </ion-label>
      </div>
    </div>
    <ion-buttons class="margin-top" slot="primary">
      <ion-button (click)="onShowSuggestions()">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="18"
          height="16"
          viewBox="0 0 18 16"
          fill="none"
        >
          <path
            d="M1.25002 15.5C1.09002 15.5 0.950021 15.46 0.830021 15.37C0.710021 15.29 0.610021 15.18 0.560021 15.04C0.500021 14.92 0.490022 14.77 0.510022 14.62C0.540022 14.47 0.600023 14.34 0.710023 14.23C1.36002 13.51 1.88002 12.65 2.21002 11.72C1.71002 11.19 1.31002 10.59 1.02002 9.92C0.69002 9.15 0.51002 8.34 0.50002 7.51C0.49002 3.64 4.30002 0.5 8.99002 0.5C13.68 0.5 17.49 3.64 17.49 7.5C17.49 11.36 13.68 14.5 8.99002 14.5C7.90002 14.54 6.78002 14.32 5.73002 13.96C4.44002 14.93 2.86002 15.47 1.25002 15.5ZM8.99002 1.5C4.85002 1.5 1.49002 4.19 1.49002 7.5C1.50002 8.2 1.65002 8.88 1.93002 9.52C2.21002 10.16 2.61002 10.74 3.12002 11.22L3.34002 11.43L3.25002 11.73C2.94002 12.72 2.45002 13.65 1.81002 14.46C3.09002 14.33 4.32002 13.82 5.32002 13L5.54002 12.82L5.81002 12.92C6.83002 13.31 7.89002 13.5 8.98002 13.5H8.99002C13.13 13.5 16.49 10.81 16.49 7.5C16.49 4.19 13.13 1.5 8.99002 1.5Z"
            fill="#111C3C"
          />
        </svg>

        <label class="comment-bar" for="">Suggest</label>
      </ion-button>
      <ion-button (click)="onShare()">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="18.003"
          height="15.025"
          viewBox="0 0 18.003 15.025"
        >
          <path
            id="Icon_ionic-ios-share-alt"
            data-name="Icon ionic-ios-share-alt"
            d="M21.351,12.63,15.106,6.855a.321.321,0,0,0-.248-.105c-.195.009-.443.144-.443.35V10a.188.188,0,0,1-.159.179c-6.21.941-8.826,5.535-9.751,10.3-.035.188.221.363.341.214a11.329,11.329,0,0,1,9.384-4.7.217.217,0,0,1,.186.21v2.844a.381.381,0,0,0,.642.232l6.29-5.876a.48.48,0,0,0,.155-.368A.582.582,0,0,0,21.351,12.63Z"
            transform="translate(-3.999 -6.249)"
            fill="none"
            stroke="#111c3c"
            stroke-width="1"
          />
        </svg>

        <label class="comment-bar" for="">Share</label>
      </ion-button>
    </ion-buttons>
  </footer>
</div>
